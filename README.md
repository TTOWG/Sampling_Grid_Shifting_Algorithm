# Sampling Grid Shifting Algorithm

  
https://essopenarchive.org/doi/full/10.1002/essoar.10502569.1
   
In this project, a new non-ergodic spatial bootstrap (re-sampling) algorithm is formulated and implemented in R language. The algorithm generates a suite of spatial coordinates for each of all possible shiftings of a sampling grid; hence, it is codenamed sampling grid shifting algorithm (SGSA). Thereafter, it generates a repeated set of sample data by sampling a simulated full-grid realization of the field at each shifted sampling grid. Each suite of spatial coordinates generated as well as the data sampled thereat makes up a repeated sample of the field. As a repeated sample is generated, its content (coordinates and data) is written to a file of desired format (e.g. .csv). These files are the runtime output of the algorithm. The algorithm is implemented in R as a function named sgsa.

The function file (function_sgsa.R) can be downloaded into users’ R workspace and then be loaded into the calling environment with the command: source(“function_sgsa.R”). Once loaded, the function can be called using the command: sgsa(), with required arguments. The first input of sgsa is sampledata. It is a data frame containing the sample point coordinates and the attribute values of the original sample data to be bootstrapped. Depending on the dimensionality at hand, sampledata may contain up to four columns (4). Relevant coordinate values should occupy the first set of columns in the order x-, y-, z-coordinates. Attributes values should occupy the last column. The column headers should be named as x_coord, y_coord, z_coord, and attribute, respectively. Any direction not relevant to the field (e.g., z-direction in an x-y 2D field) should simply be omitted in sampledata. The function accommodates cases of redundant directions – the field being of higher dimensionality than the sampling grid. For example, a field may be 3-D (x-, y-, z-directions) in space while the attribute is invariant in z-direction and therefore sampled only in x-y plane. This makes the z-direction relevant to the field but redundant in the context of bootstrapping the sample data. In such cases, sampledata should still be prepared as a 3-D case with the redundant coordinate values set to a constant value for all the data points. The constant value may be set as the value of the redundant direction corresponding to the sampling plane.

 The next three input parameters of sgsa are x_origin, y_origin and z_origin. These specify the coordinates of the origin of the field. The default values of these origin coordinates have been set to zero. Hence, users may omit any or all of these inputs in a call to sgsa, if the default values are appropriate. Irrelevant or redundant direction(s) should also be omitted. The numbers of gridblocks into which the field should be discretized are to be specified using inputs nx, ny, nz. Each of these has been set to a default value of 1. The default value, 1, is appropriate for any direction that is not relevant to the field at hand and/or any direction that is redundant in the context the bootstrapping task at hand. Hence, in calling sgsa, users should omit any of  nx, ny, nz corresponding to an irrelevant or redundant direction. The gridblock sizes are specified in the next three inputs: deltaX, deltaY and deltaZ. These also have been set to default values of zero. The default value of zero is appropriate for a direction that is not relevant to the field. Hence, users should specify non-default values for directions relevant to the field being considered and simply omit the irrelevant direction(s).
 
The last four input parameters of sgsa are vargmodel, beta,  nmin and nmax.  These respectively correspond to model, beta, nmin and nmax parameters of gstat function in gstat – an open-source R package for geostatistical simulations. Parameter vargmodel should be the variogram model obtained from the data and should be defined by calling vgm in the gstat package. Parameter beta is only applicable if the full-grid simulation of the field is to be based on simple kriging. In that case, it should be specified as the expected value of the attribute.  Parameters nmin and nmax are the minimum and maximum number of nearest data observations to be used in simulation, respectively.

Contact the developer at olatunde.mosobalaje@covenantuniversity.edu.ng
